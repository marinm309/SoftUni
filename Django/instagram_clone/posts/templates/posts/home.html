{% extends 'main.html' %}

{% block content %}

{% load static %}

{% for post in posts %}
{% if post.user in lst or post.user == user %}

<div class="post-wrapper">
        <div class="post-top">
            <div class="user-img home"><a href="{% url 'profile' post.user %}"><img src="{{post.user.user.profile.profile_pic.url}}" alt=""></a></div>
            <div class="user-name"><h5><a href="{% url 'profile' post.user %}">{{post.user}}</a></h5></div>
            {% if post.user not in lst and post.user != user %}
            <div class="user-follow"><a href="{% url 'follow' post.user.id %}">Follow</a></div>
            {% elif post.user in lst %}
            <div class="user-follow"><a href="{% url 'unfollow' post.user.id %}" style="color: rgb(245, 56, 56);">Unfollow</a></div>
            {% endif %}
        </div>
        {% if post.post_type == 'photo' %}
        <div class="post-img"><img src="{{post.file_upload.url}}" alt=""></div>
        {% elif post.post_type == 'video' %}
        <div class="post-img">
            <video controls muted width="400">
                <source src="{{post.file_upload.url}}" type="video/mp4">
            </video>
        </div>
        {% endif %}
        <div class="post-bottom">
            <div class="post-like">
                <div class="like-btn"><a class="like" href="{% url 'like-post' post.id %}"><span class="hearth">&#9829;</span></a></div>
                <div class="like-num"><h5><span class="ajax-likes" id="{{post.id}}">{{post.num_of_likes}}</span> Like{{post.num_of_likes|pluralize:"s"}}</h5></div>
            </div>
            <div class="post-description"><span><h5>{{post.user}}</h5></span><p>{{post.description}}</p></div>
            <div class="post-comments">

                <div class="view-comments"><p><a href="{% url 'single-post' post.id %}">View all <span class="{{post.id}}">{{post.num_of_comments}}</span> comment{{post.num_of_comments|pluralize:"s"}}</a></p></div>
                
                <div class="time-ago"><h6>{{post.get_date}}</h6></div>
                <div class="add-comments">
                    <form action="{% url 'create-comment' post.id %}" method="POST">
                        {% csrf_token %}
                        <input class="type-comments" id="o{{post.id}}" type="text" placeholder="Add a comment..." name="comment">
                        <input class="post-comments comment-btn" value="Post" type="submit" data-href="{% url 'create-comment' post.id %}" data-id="o{{post.id}}">
                    </form>
                </div>
            </div>
        </div>
</div>
{% endif %}
{% endfor %}
<hr>
{% for post in posts %}
{% if post.user not in lst and post.user != user %}
<div class="post-wrapper">
        <div class="post-top">
            <div class="user-img home"><a href="{% url 'profile' post.user %}"><img src="{{post.user.user.profile.profile_pic.url}}" alt=""></a></div>
            <div class="user-name"><h5><a href="{% url 'profile' post.user %}">{{post.user}}</a></h5></div>
            {% if post.user not in lst and post.user != user %}
            <div class="user-follow"><a href="{% url 'follow' post.user.id %}">Follow</a></div>
            {% elif post.user in lst %}
            <div class="user-follow"><a href="{% url 'unfollow' post.user.id %}" style="color: rgb(245, 56, 56);">Unfollow</a></div>
            {% endif %}
        </div>
        <div class="post-img"><img src="{{post.file_upload.url}}" alt=""></div>
        <div class="post-bottom">
            <div class="post-like">
                <div class="like-btn"><a class="like" href="{% url 'like-post' post.id %}"><span class="hearth">&#9829;</span></a></div>
                <div class="like-num"><h5><span class="ajax-likes" id="{{post.id}}">{{post.num_of_likes}}</span> Like{{post.num_of_likes|pluralize:"s"}}</h5></div>
            </div>
            <div class="post-description"><span><h5>{{post.user}}</h5></span><p>{{post.description}}</p></div>
            <div class="post-comments">

                <div class="view-comments"><p><a href="{% url 'single-post' post.id %}">View all <span class="{{post.id}}">{{post.num_of_comments}}</span> comment{{post.num_of_comments|pluralize:"s"}}</a></p></div>
                
                <div class="time-ago"><h6>{{post.get_date}}</h6></div>
                <div class="add-comments">
                    <form action="{% url 'create-comment' post.id %}" method="POST">
                        {% csrf_token %}
                        <input class="type-comments" id="o{{post.id}}" type="text" placeholder="Add a comment..." name="comment">
                        <input class="post-comments comment-btn" value="Post" type="submit" data-href="{% url 'create-comment' post.id %}" data-id="o{{post.id}}">
                    </form>
                </div>
            </div>
        </div>
</div>
{% endif %}
{% endfor %}


{% endblock content %}